{
  "uid": 2,
  "caption": "Authentication",
  "description": "Authentication events report authentication session activities, including user attempts to log on or log off, regardless of success, as well as other key stages within the authentication process. These events are typically generated by authentication services, such as Kerberos, OIDC, or SAML, and may include information about the user, the authentication method used, and the status of the authentication attempt.",
  "extends": "iam",
  "name": "authentication",
  "associations": {
    "actor.user": [
      "src_endpoint"
    ],
    "dst_endpoint": [
      "user"
    ],
    "src_endpoint": [
      "actor.user"
    ],
    "user": [
      "dst_endpoint"
    ]
  },
  "attributes": {
    "account_switch_type": {
      "group": "primary",
      "requirement": "recommended"
    },
    "account_switch_type_id": {
      "group": "primary",
      "requirement": "recommended"
    },
    "activity_id": {
      "enum": {
        "1": {
          "caption": "Logon",
          "description": "A new logon session was requested."
        },
        "2": {
          "caption": "Logoff",
          "description": "A logon session was terminated and no longer exists."
        },
        "3": {
          "caption": "Authentication Ticket",
          "description": "A Kerberos authentication ticket (TGT) was requested."
        },
        "4": {
          "caption": "Service Ticket Request",
          "description": "A Kerberos service ticket was requested."
        },
        "5": {
          "caption": "Service Ticket Renew",
          "description": "A Kerberos service ticket was renewed."
        },
        "6": {
          "caption": "Preauth",
          "description": "A preauthentication stage was engaged."
        },
        "7": {
          "caption": "Account Switch",
          "description": "A utility or service switched the user account. See the <code>account_switch_type_id</code> attribute for more details."
        }
      }
    },
    "auth_factors": {
      "description": "Describes a category of methods used for identity verification in an authentication attempt.",
      "group": "context",
      "requirement": "optional"
    },
    "auth_protocol": {
      "group": "primary",
      "requirement": "recommended"
    },
    "auth_protocol_id": {
      "group": "primary",
      "requirement": "recommended"
    },
    "authentication_token": {
      "description": "The authentication token, ticket, or assertion, e.g. <code>Kerberos</code>, <code>OIDC</code>, <code>SAML</code>.",
      "group": "context",
      "requirement": "optional",
      "references": [
        {
          "description": "RFC 4120: The Kerberos Network Authentication Service (V5)",
          "url": "https://www.rfc-editor.org/rfc/rfc4120"
        },
        {
          "description": "OpenID Connect Core 1.0",
          "url": "https://openid.net/specs/openid-connect-core-1_0.html"
        },
        {
          "description": "The OASIS Security Assertion Markup Language (SAML) V2.0",
          "url": "https://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf"
        }
      ]
    },
    "certificate": {
      "description": "The certificate associated with the authentication or pre-authentication (Kerberos).",
      "group": "primary",
      "requirement": "recommended"
    },
    "dst_endpoint": {
      "description": "The endpoint to which the authentication was targeted.",
      "group": "primary",
      "requirement": "recommended"
    },
    "is_cleartext": {
      "group": "context",
      "requirement": "optional"
    },
    "is_mfa": {
      "group": "primary",
      "requirement": "recommended"
    },
    "is_new_logon": {
      "group": "context",
      "requirement": "optional"
    },
    "is_remote": {
      "description": "The attempted authentication is over a remote connection.",
      "group": "primary",
      "requirement": "recommended"
    },
    "logon_process": {
      "group": "context",
      "requirement": "optional"
    },
    "logon_type": {
      "group": "primary",
      "requirement": "recommended"
    },
    "logon_type_id": {
      "group": "primary",
      "requirement": "recommended"
    },
    "service": {
      "description": "The service or gateway to which the user or process is being authenticated",
      "group": "primary",
      "requirement": "recommended"
    },
    "session": {
      "group": "primary",
      "requirement": "recommended"
    },
    "status_detail": {
      "description": "The details about the authentication request. For example, possible details for Windows logon or logoff events are:<ul><li>Success</li><ul><li>LOGOFF_USER_INITIATED</li><li>LOGOFF_OTHER</li></ul><li>Failure</li><ul><li>USER_DOES_NOT_EXIST</li><li>INVALID_CREDENTIALS</li><li>ACCOUNT_DISABLED</li><li>ACCOUNT_LOCKED_OUT</li><li>PASSWORD_EXPIRED</li></ul></ul>"
    },
    "user": {
      "description": "The subject (user/role or account) to authenticate.",
      "group": "primary",
      "requirement": "required"
    }
  },
  "constraints": {
    "at_least_one": [
      "service",
      "dst_endpoint"
    ]
  }
}